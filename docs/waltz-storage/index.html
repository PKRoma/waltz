<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Waltz Storage · Waltz</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="Waltz Storage is a storage server which provides persistency to Waltz. Its functionality is designed to be limited to relatively simple set of commands. Waltz centralizes the responsibility of transaction consistency and a fault recovery to Waltz Server. Waltz Storage has following ten request/response patterns."/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Waltz Storage · Waltz"/><meta property="og:type" content="website"/><meta property="og:url" content="https://wepay.github.io/waltz/"/><meta property="og:description" content="Waltz Storage is a storage server which provides persistency to Waltz. Its functionality is designed to be limited to relatively simple set of commands. Waltz centralizes the responsibility of transaction consistency and a fault recovery to Waltz Server. Waltz Storage has following ten request/response patterns."/><meta property="og:image" content="https://wepay.github.io/waltz/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://wepay.github.io/waltz/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/waltz/img/favicon.ico"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/waltz/js/scrollSpy.js"></script><link rel="stylesheet" href="/waltz/css/main.css"/><script src="/waltz/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/waltz/"><img class="logo" src="/waltz/img/favicon.ico" alt="Waltz"/><h2 class="headerTitleWithLogo">Waltz</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/waltz/docs/introduction" target="_self">Docs</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Design</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Design</h3><ul class=""><li class="navListItem"><a class="navItem" href="/waltz/docs/introduction">Introduction</a></li><li class="navListItem"><a class="navItem" href="/waltz/docs/terminology">Terminology and Components</a></li><li class="navListItem"><a class="navItem" href="/waltz/docs/application-programming-model">Application Programming Model</a></li><li class="navListItem"><a class="navItem" href="/waltz/docs/client-server-communication">Client-Server Communication</a></li><li class="navListItem"><a class="navItem" href="/waltz/docs/server-storage-communication">Server-Storage Communication</a></li><li class="navListItem"><a class="navItem" href="/waltz/docs/on-disk-data-structures">On-Disk Data Structures</a></li><li class="navListItem"><a class="navItem" href="/waltz/docs/concurrency-control-optimistic-locking">Concurrency Control (Optimistic Locking)</a></li><li class="navListItem"><a class="navItem" href="/waltz/docs/back-pressure">Back Pressure</a></li><li class="navListItem"><a class="navItem" href="/waltz/docs/waltz-client">Waltz Client</a></li><li class="navListItem"><a class="navItem" href="/waltz/docs/waltz-server">Waltz Server</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/waltz/docs/waltz-storage">Waltz Storage</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Administration</h3><ul class=""><li class="navListItem"><a class="navItem" href="/waltz/docs/waltz-setup">Waltz Setup</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 id="__docusaurus" class="postHeaderTitle">Waltz Storage</h1></header><article><div><span><p>Waltz Storage is a storage server which provides persistency to Waltz. Its functionality is designed to be limited to relatively simple set of commands. Waltz centralizes the responsibility of transaction consistency and a fault recovery to Waltz Server. Waltz Storage has following ten request/response patterns.</p>
<ol>
<li>Open Request → { Success Response | Failure Response }</li>
<li>Last Session Info Request → { Last Session Info Response | Failure Response }</li>
<li>Max Transaction ID Request → { Max Transaction ID Response | Failure Response }</li>
<li>Truncate Request → { Success Response | Failure Response }</li>
<li>Set Low-water Mark Request → { Success Response | Failure Response }</li>
<li>Append Request → { Success Response | Failure Response }</li>
<li>Record Header Request → { Record Header Response | Failure Response }</li>
<li>Record Request → { Record Response | Failure Response }</li>
<li>Record Header List Request → { Record Header List Response | Failure Response }</li>
<li>Record List Request → { Record List Response | Failure Response }</li>
</ol>
<h2><a class="anchor" aria-hidden="true" id="open-request"></a><a href="#open-request" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Open Request</h2>
<table>
<thead>
<tr><th>Field</th><th>Data Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Session ID</td><td>long</td><td>-1</td></tr>
<tr><td>Sequence number</td><td>long</td><td>-1</td></tr>
<tr><td>Partition ID</td><td>int</td><td>-1</td></tr>
<tr><td>Cluster key</td><td>UUID</td><td>A unique ID of the cluster</td></tr>
<tr><td>Number of partitions</td><td>int</td><td>The number of partitions</td></tr>
</tbody>
</table>
<p>Open request is the first request a Waltz server makes after a connection to a storage server is opened. A Waltz server sends a cluster key which is UUID assigned to a cluster when a cluster is created by an admin tool. The storage server compares it with the one in the control file. If they don’t match, it indicates there is a configuration error.</p>
<h2><a class="anchor" aria-hidden="true" id="last-session-info-request"></a><a href="#last-session-info-request" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Last Session Info Request</h2>
<table>
<thead>
<tr><th>Field</th><th>Data Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Session ID</td><td>long</td><td>The store session ID</td></tr>
<tr><td>Sequence number</td><td>long</td><td>The message sequence number</td></tr>
<tr><td>Partition ID</td><td>int</td><td>The partition ID</td></tr>
</tbody>
</table>
<p>Last Session Info request is sent by the recovery manager when a replica connection is opened. It requests the information of the last store session of the storage partition on this storage server. It comes from Partition Info on the control file. The low-water mark is the high-water mark of the partition when the store session started.</p>
<h2><a class="anchor" aria-hidden="true" id="last-session-info-response"></a><a href="#last-session-info-response" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Last Session Info Response</h2>
<table>
<thead>
<tr><th>Field</th><th>Data Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Session ID</td><td>long</td><td>The store session ID</td></tr>
<tr><td>Sequence number</td><td>long</td><td>The message sequence number</td></tr>
<tr><td>Partition ID</td><td>int</td><td>The partition ID</td></tr>
<tr><td>Session ID</td><td>long</td><td>The last store session ID</td></tr>
<tr><td>Low-water Mark</td><td>long</td><td>The low-water mark of the last session</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="max-transaction-id-request"></a><a href="#max-transaction-id-request" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Max Transaction ID Request</h2>
<table>
<thead>
<tr><th>Field</th><th>Data Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Session ID</td><td>long</td><td>The store session ID</td></tr>
<tr><td>Sequence number</td><td>long</td><td>The message sequence number</td></tr>
<tr><td>Partition ID</td><td>int</td><td>The partition ID</td></tr>
</tbody>
</table>
<p>This requests the max transaction ID of the specified storage partition. The transaction may not be  committed yet.</p>
<h2><a class="anchor" aria-hidden="true" id="max-transaction-id-response"></a><a href="#max-transaction-id-response" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Max Transaction ID Response</h2>
<table>
<thead>
<tr><th>Field</th><th>Data Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Session ID</td><td>long</td><td>The store session ID</td></tr>
<tr><td>Sequence number</td><td>long</td><td>The message sequence number</td></tr>
<tr><td>Partition ID</td><td>int</td><td>The partition ID</td></tr>
<tr><td>Transaction ID</td><td>long</td><td>The max transaction ID of the partition on the storage server</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="truncate-request"></a><a href="#truncate-request" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Truncate Request</h2>
<table>
<thead>
<tr><th>Field</th><th>Data Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Session ID</td><td>long</td><td>The store session ID</td></tr>
<tr><td>Sequence number</td><td>long</td><td>The message sequence number</td></tr>
<tr><td>Partition ID</td><td>int</td><td>The partition ID</td></tr>
<tr><td>Transaction ID</td><td>long</td><td>The max transaction ID to retain. Any transaction after this transaction ID will be removed.</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="set-low-water-mark-request"></a><a href="#set-low-water-mark-request" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Set Low-water Mark Request</h2>
<table>
<thead>
<tr><th>Field</th><th>Data Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Session ID</td><td>long</td><td>The store session ID</td></tr>
<tr><td>Sequence number</td><td>long</td><td>The message sequence number</td></tr>
<tr><td>Partition ID</td><td>int</td><td>The partition ID</td></tr>
<tr><td>Low-water mark</td><td>long</td><td>The low-water mark which is the max transaction ID when this store session is started.</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="append-request"></a><a href="#append-request" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Append Request</h2>
<table>
<thead>
<tr><th>Field</th><th>Data Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Session ID</td><td>long</td><td>The store session ID</td></tr>
<tr><td>Sequence number</td><td>long</td><td>The message sequence number</td></tr>
<tr><td>Partition ID</td><td>int</td><td>The partition ID</td></tr>
<tr><td>Record List Length</td><td>int</td><td>The number of transaction records</td></tr>
<tr><td>Record List</td><td>Record[]</td><td>The list of records</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="recordheader"></a><a href="#recordheader" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>RecordHeader</h2>
<table>
<thead>
<tr><th>Field</th><th>Data Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Transaction ID</td><td>long</td><td>The transaction ID</td></tr>
<tr><td>Request ID</td><td>ReqId</td><td>Client generated unique request ID</td></tr>
<tr><td>Transaction Header</td><td>int</td><td>The transaction header</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="record"></a><a href="#record" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Record</h2>
<table>
<thead>
<tr><th>Field</th><th>Data Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Transaction ID</td><td>long</td><td>The transaction ID</td></tr>
<tr><td>Request ID</td><td>ReqId</td><td>Client generated unique request ID</td></tr>
<tr><td>Transaction Header</td><td>int</td><td>The transaction header</td></tr>
<tr><td>Transaction Data Length</td><td>int</td><td>The length of transaction data</td></tr>
<tr><td>Transaction Data</td><td>byte[]</td><td>A byte array</td></tr>
<tr><td>Checksum</td><td>int</td><td>CRC32 of transaction data</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="record-header-request"></a><a href="#record-header-request" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Record Header Request</h2>
<table>
<thead>
<tr><th>Field</th><th>Data Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Session ID</td><td>long</td><td>The store session ID</td></tr>
<tr><td>Sequence number</td><td>long</td><td>The message sequence number</td></tr>
<tr><td>Partition ID</td><td>int</td><td>The partition ID</td></tr>
<tr><td>Transaction ID</td><td>long</td><td>The transaction ID</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="request-header-response"></a><a href="#request-header-response" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Request Header Response</h2>
<table>
<thead>
<tr><th>Field</th><th>Data Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Session ID</td><td>long</td><td>The store session ID</td></tr>
<tr><td>Sequence number</td><td>long</td><td>The message sequence number</td></tr>
<tr><td>Partition ID</td><td>int</td><td>The partition ID</td></tr>
<tr><td>Record header</td><td>RecordHeader</td><td>The transaction record header</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="record-request"></a><a href="#record-request" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Record Request</h2>
<table>
<thead>
<tr><th>Field</th><th>Data Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Session ID</td><td>long</td><td>The store session ID</td></tr>
<tr><td>Sequence number</td><td>long</td><td>The message sequence number</td></tr>
<tr><td>Partition ID</td><td>int</td><td>The partition ID</td></tr>
<tr><td>Transaction ID</td><td>long</td><td>The transaction ID</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="record-response"></a><a href="#record-response" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Record Response</h2>
<table>
<thead>
<tr><th>Field</th><th>Data Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Session ID</td><td>long</td><td>The store session ID</td></tr>
<tr><td>Sequence number</td><td>long</td><td>The message sequence number</td></tr>
<tr><td>Partition ID</td><td>int</td><td>The partition ID</td></tr>
<tr><td>Record</td><td>Record</td><td>The transaction record</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="record-header-list-request"></a><a href="#record-header-list-request" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Record Header List Request</h2>
<table>
<thead>
<tr><th>Field</th><th>Data Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Session ID</td><td>long</td><td>The store session ID</td></tr>
<tr><td>Sequence number</td><td>long</td><td>The message sequence number</td></tr>
<tr><td>Partition ID</td><td>int</td><td>The partition ID</td></tr>
<tr><td>Transaction ID</td><td>long</td><td>The transaction ID</td></tr>
<tr><td>Max number of records</td><td>int</td><td>The maximum number of records to fetch</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="request-header-list-response"></a><a href="#request-header-list-response" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Request Header List Response</h2>
<table>
<thead>
<tr><th>Field</th><th>Data Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Session ID</td><td>long</td><td>The store session ID</td></tr>
<tr><td>Sequence number</td><td>long</td><td>The message sequence number</td></tr>
<tr><td>Partition ID</td><td>int</td><td>The partition ID</td></tr>
<tr><td>Record header list Length</td><td>int</td><td>The number of record headers</td></tr>
<tr><td>Record header list</td><td>RecordHeader[]</td><td>The list of transaction record headers</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="record-list-request"></a><a href="#record-list-request" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Record List Request</h2>
<table>
<thead>
<tr><th>Field</th><th>Data Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Session ID</td><td>long</td><td>The store session ID</td></tr>
<tr><td>Sequence number</td><td>long</td><td>The message sequence number</td></tr>
<tr><td>Partition ID</td><td>int</td><td>The partition ID</td></tr>
<tr><td>Transaction ID</td><td>long</td><td>The transaction ID</td></tr>
<tr><td>Max number of records</td><td>int</td><td>The maximum number of records to fetch</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="record-list-response"></a><a href="#record-list-response" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Record List Response</h2>
<table>
<thead>
<tr><th>Field</th><th>Data Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Session ID</td><td>long</td><td>The store session ID</td></tr>
<tr><td>Sequence number</td><td>long</td><td>The message sequence number</td></tr>
<tr><td>Partition ID</td><td>int</td><td>The partition ID</td></tr>
<tr><td>Record List Length</td><td>int</td><td>The number of records</td></tr>
<tr><td>Record List</td><td>Record[]</td><td>The list of transaction record headers</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="success-response"></a><a href="#success-response" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Success Response</h2>
<table>
<thead>
<tr><th>Field</th><th>Data Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Session ID</td><td>long</td><td>The store session ID</td></tr>
<tr><td>Sequence number</td><td>long</td><td>The message sequence number</td></tr>
<tr><td>Partition ID</td><td>int</td><td>The partition ID</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="failure-response"></a><a href="#failure-response" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Failure Response</h2>
<table>
<thead>
<tr><th>Field</th><th>Data Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Session ID</td><td>long</td><td>The store session ID</td></tr>
<tr><td>Sequence number</td><td>long</td><td>The message sequence number</td></tr>
<tr><td>Partition ID</td><td>int</td><td>The partition ID</td></tr>
<tr><td>Exception</td><td>StorageRpcException</td><td>The exception information</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="storagerpcexception"></a><a href="#storagerpcexception" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>StorageRpcException</h2>
<table>
<thead>
<tr><th>Field</th><th>Data Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Message</td><td>String</td><td>The exception message</td></tr>
<tr><td>Stack Trace Length</td><td>int</td><td>The number of stack trace elements</td></tr>
<tr><td>Stack Trace Element *repeat</td><td></td><td></td></tr>
<tr><td>Class name</td><td>String</td><td>The class name</td></tr>
<tr><td>Method name</td><td>String</td><td>The method name</td></tr>
<tr><td>File name</td><td>String</td><td>The file name</td></tr>
<tr><td>Line number</td><td>int</td><td>The line number</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="replica-assignments"></a><a href="#replica-assignments" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Replica Assignments</h2>
<p>The assignment of replicas to the storage serves are stored in Zookeeper. The ZNode path is <code>&lt;cluster root&gt;/store/assignment</code>. This data is initialized when a cluster is configured. It can be updated dynamically with Zookeeper CLI tool.</p>
<h3><a class="anchor" aria-hidden="true" id="replica-assignments-1"></a><a href="#replica-assignments-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Replica Assignments</h3>
<table>
<thead>
<tr><th>Field</th><th>Data Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Map of Storage to Partition ID List *repeat</td><td></td><td></td></tr>
<tr><td>Connect String</td><td>String</td><td>The connect string (host:port)</td></tr>
<tr><td>Replica IDs</td><td>int[]</td><td>The array of Replica IDs</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="group-descriptor"></a><a href="#group-descriptor" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Group Descriptor</h2>
<p>The descriptor of replica group assignments are stored in Zookeeper. The ZNode path is <code>&lt;cluster root&gt;/store/group</code>. This data is initialized when a cluster is configured. It can be updated dynamically with Zookeeper CLI tool.</p>
<h3><a class="anchor" aria-hidden="true" id="group-descriptor-1"></a><a href="#group-descriptor-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Group Descriptor</h3>
<table>
<thead>
<tr><th>Field</th><th>Data Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Map of Connect String to Group ID *repeat</td><td></td><td></td></tr>
<tr><td>Connect String</td><td>String</td><td>The connect string (host:port)</td></tr>
<tr><td>Group ID</td><td>Integer</td><td>The group ID it belongs to</td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="storage-administration"></a><a href="#storage-administration" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Storage Administration</h2>
<p>The Waltz storage server also exposes a separate port for administrative operations such as marking the storage node offline or online, or assigning a partition to the storage node. This client is implemented using the same client as the normal storage client, but with a different set of administrative messages as its protocol.</p>
<h3><a class="anchor" aria-hidden="true" id="admin-open-request"></a><a href="#admin-open-request" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Admin Open Request</h3>
<table>
<thead>
<tr><th>Field</th><th>Data Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Sequence number</td><td>long</td><td>-1</td></tr>
<tr><td>Cluster key</td><td>UUID</td><td>A unique ID of the cluster</td></tr>
<tr><td>Number of partitions</td><td>int</td><td>The number of partitions</td></tr>
</tbody>
</table>
<h3><a class="anchor" aria-hidden="true" id="partition-assignment-request"></a><a href="#partition-assignment-request" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Partition Assignment Request</h3>
<table>
<thead>
<tr><th>Field</th><th>Data Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Sequence number</td><td>long</td><td>The message sequence number</td></tr>
<tr><td>Partition ID</td><td>int</td><td>The partition ID</td></tr>
<tr><td>Toggled</td><td>boolean</td><td>Create (true) or delete the partition (false) on the storage node</td></tr>
</tbody>
</table>
<h3><a class="anchor" aria-hidden="true" id="partition-read-request"></a><a href="#partition-read-request" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Partition Read Request</h3>
<table>
<thead>
<tr><th>Field</th><th>Data Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Sequence number</td><td>long</td><td>The message sequence number</td></tr>
<tr><td>Partition ID</td><td>int</td><td>The partition ID</td></tr>
<tr><td>Toggled</td><td>boolean</td><td>Mark the partition as readable (true) or unreadable (false) on the storage node</td></tr>
</tbody>
</table>
<h3><a class="anchor" aria-hidden="true" id="partition-write-request"></a><a href="#partition-write-request" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Partition Write Request</h3>
<table>
<thead>
<tr><th>Field</th><th>Data Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Sequence number</td><td>long</td><td>The message sequence number</td></tr>
<tr><td>Partition ID</td><td>int</td><td>The partition ID</td></tr>
<tr><td>Toggled</td><td>boolean</td><td>Mark the partition as writable (true) or unwritable (false) on the storage node</td></tr>
</tbody>
</table>
<h3><a class="anchor" aria-hidden="true" id="admin-success-response"></a><a href="#admin-success-response" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Admin Success Response</h3>
<table>
<thead>
<tr><th>Field</th><th>Data Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Sequence number</td><td>long</td><td>The message sequence number</td></tr>
</tbody>
</table>
<h3><a class="anchor" aria-hidden="true" id="admin-failure-response"></a><a href="#admin-failure-response" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Admin Failure Response</h3>
<table>
<thead>
<tr><th>Field</th><th>Data Type</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Sequence number</td><td>long</td><td>The message sequence number</td></tr>
<tr><td>Exception</td><td>StorageRpcException</td><td>The exception information</td></tr>
</tbody>
</table>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/waltz/docs/waltz-server"><span class="arrow-prev">← </span><span>Waltz Server</span></a><a class="docs-next button" href="/waltz/docs/waltz-setup"><span>Waltz Setup</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#open-request">Open Request</a></li><li><a href="#last-session-info-request">Last Session Info Request</a></li><li><a href="#last-session-info-response">Last Session Info Response</a></li><li><a href="#max-transaction-id-request">Max Transaction ID Request</a></li><li><a href="#max-transaction-id-response">Max Transaction ID Response</a></li><li><a href="#truncate-request">Truncate Request</a></li><li><a href="#set-low-water-mark-request">Set Low-water Mark Request</a></li><li><a href="#append-request">Append Request</a></li><li><a href="#recordheader">RecordHeader</a></li><li><a href="#record">Record</a></li><li><a href="#record-header-request">Record Header Request</a></li><li><a href="#request-header-response">Request Header Response</a></li><li><a href="#record-request">Record Request</a></li><li><a href="#record-response">Record Response</a></li><li><a href="#record-header-list-request">Record Header List Request</a></li><li><a href="#request-header-list-response">Request Header List Response</a></li><li><a href="#record-list-request">Record List Request</a></li><li><a href="#record-list-response">Record List Response</a></li><li><a href="#success-response">Success Response</a></li><li><a href="#failure-response">Failure Response</a></li><li><a href="#storagerpcexception">StorageRpcException</a></li><li><a href="#replica-assignments">Replica Assignments</a><ul class="toc-headings"><li><a href="#replica-assignments-1">Replica Assignments</a></li></ul></li><li><a href="#group-descriptor">Group Descriptor</a><ul class="toc-headings"><li><a href="#group-descriptor-1">Group Descriptor</a></li></ul></li><li><a href="#storage-administration">Storage Administration</a><ul class="toc-headings"><li><a href="#admin-open-request">Admin Open Request</a></li><li><a href="#partition-assignment-request">Partition Assignment Request</a></li><li><a href="#partition-read-request">Partition Read Request</a></li><li><a href="#partition-write-request">Partition Write Request</a></li><li><a href="#admin-success-response">Admin Success Response</a></li><li><a href="#admin-failure-response">Admin Failure Response</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/waltz/" class="nav-home"><img src="/waltz/img/favicon.ico" alt="Waltz" width="66" height="58"/></a><div><h5>Docs</h5><a href="/waltz/docs/introduction">Design</a><a href="/waltz/docs/waltz-setup">Administration</a><a href="/waltz/docs/application-programming-model">API Reference</a></div><div><h5>Community</h5><a href="https://stackoverflow.com/questions/tagged/" target="_blank" rel="noreferrer noopener">Stack Overflow</a><a href="https://twitter.com/WePay" target="_blank" rel="noreferrer noopener">Twitter</a></div><div><h5>More</h5><a href="https://wecode.wepay.com">Blog</a><a href="https://github.com/wepay/waltz">GitHub</a></div></section><section class="copyright">Copyright © 2019 WePay Inc.</section></footer></div></body></html>